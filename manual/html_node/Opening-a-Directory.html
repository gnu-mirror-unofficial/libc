<html lang="en">
<head>
<title>The GNU C Library</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name=description content="The GNU C Library">
<meta name=generator content="makeinfo 4.2">
<link href="http://www.gnu.org/software/texinfo/" rel=generator-home>
</head>
<body>
<p>
Node:<a name="Opening%20a%20Directory">Opening a Directory</a>,
Next:<a rel=next accesskey=n href="Reading-Closing-Directory.html#Reading%2fClosing%20Directory">Reading/Closing Directory</a>,
Previous:<a rel=previous accesskey=p href="Directory-Entries.html#Directory%20Entries">Directory Entries</a>,
Up:<a rel=up accesskey=u href="Accessing-Directories.html#Accessing%20Directories">Accessing Directories</a>
<hr><br>

<h4>Opening a Directory Stream</h4>

<p>This section describes how to open a directory stream.  All the symbols
are declared in the header file <code>dirent.h</code>.

<p>
<table width="100%">
<tr>
<td align="left"><b>DIR</b><i>
</i></td>
<td align="right">Data Type</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
The <code>DIR</code> data type represents a directory stream. 
</td></tr>
</table>

<p>You shouldn't ever allocate objects of the <code>struct dirent</code> or
<code>DIR</code> data types, since the directory access functions do that for
you.  Instead, you refer to these objects using the pointers returned by
the following functions.

<p>
<table width="100%">
<tr>
<td align="left">DIR * <b>opendir</b><i> (const char *<var>dirname</var>)
</i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
The <code>opendir</code> function opens and returns a directory stream for
reading the directory whose file name is <var>dirname</var>.  The stream has
type <code>DIR *</code>.

<p>If unsuccessful, <code>opendir</code> returns a null pointer.  In addition to
the usual file name errors (see <a href="File-Name-Errors.html#File%20Name%20Errors">File Name Errors</a>), the
following <code>errno</code> error conditions are defined for this function:

<dl>
<dt><code>EACCES</code>
<dd>Read permission is denied for the directory named by <code>dirname</code>.

<br><dt><code>EMFILE</code>
<dd>The process has too many files open.

<br><dt><code>ENFILE</code>
<dd>The entire system, or perhaps the file system which contains the
directory, cannot support any additional open files at the moment. 
(This problem cannot happen on the GNU system.) 
</dl>

<p>The <code>DIR</code> type is typically implemented using a file descriptor,
and the <code>opendir</code> function in terms of the <code>open</code> function. 
See <a href="Low-Level-I-O.html#Low-Level%20I%2fO">Low-Level I/O</a>.  Directory streams and the underlying
file descriptors are closed on <code>exec</code> (see <a href="Executing-a-File.html#Executing%20a%20File">Executing a File</a>). 
</td></tr>
</table>

<p>In some situations it can be desirable to get hold of the file
descriptor which is created by the <code>opendir</code> call.  For instance,
to switch the current working directory to the directory just read the
<code>fchdir</code> function could be used.  Historically the <code>DIR</code> type
was exposed and programs could access the fields.  This does not happen
in the GNU C library.  Instead a separate function is provided to allow
access.

<p>
<table width="100%">
<tr>
<td align="left">int <b>dirfd</b><i> (DIR *<var>dirstream</var>)
</i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
The function <code>dirfd</code> returns the file descriptor associated with
the directory stream <var>dirstream</var>.  This descriptor can be used until
the directory is closed with <code>closedir</code>.  If the directory stream
implementation is not using file descriptors the return value is
<code>-1</code>. 
</td></tr>
</table>

</body></html>

