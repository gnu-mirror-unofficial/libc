<html lang="en">
<head>
<title>The GNU C Library</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The GNU C Library">
<meta name="generator" content="makeinfo 4.6">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
--></style>
</head>
<body>
<div class="node">
<p>
Node:&nbsp;<a name="Cleanups%20on%20Exit">Cleanups on Exit</a>,
Next:&nbsp;<a rel="next" accesskey="n" href="Aborting-a-Program.html#Aborting%20a%20Program">Aborting a Program</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Exit-Status.html#Exit%20Status">Exit Status</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Program-Termination.html#Program%20Termination">Program Termination</a>
<hr><br>
</div>

<h3 class="subsection">Cleanups on Exit</h4>

<p>Your program can arrange to run its own cleanup functions if normal
termination happens.  If you are writing a library for use in various
application programs, then it is unreliable to insist that all
applications call the library's cleanup functions explicitly before
exiting.  It is much more robust to make the cleanup invisible to the
application, by setting up a cleanup function in the library itself
using <code>atexit</code> or <code>on_exit</code>.

<p>
<table width="100%">
<tr>
<td align="left">int <b>atexit</b><i> </i>(<i>void </i>(<i>*</i><var>function</var><i></i>)<i> </i>(<i>void</i>)<i></i>)<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
The <code>atexit</code> function registers the function <var>function</var> to be
called at normal program termination.  The <var>function</var> is called with
no arguments.

     <p>The return value from <code>atexit</code> is zero on success and nonzero if
the function cannot be registered. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left">int <b>on_exit</b><i> </i>(<i>void </i>(<i>*</i><var>function</var><i></i>)<i></i>(<i>int </i><var>status</var><i>, void *</i><var>arg</var><i></i>)<i>, void *</i><var>arg</var><i></i>)<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This function is a somewhat more powerful variant of <code>atexit</code>.  It
accepts two arguments, a function <var>function</var> and an arbitrary
pointer <var>arg</var>.  At normal program termination, the <var>function</var> is
called with two arguments:  the <var>status</var> value passed to <code>exit</code>,
and the <var>arg</var>.

     <p>This function is included in the GNU C library only for compatibility
for SunOS, and may not be supported by other implementations. 
</td></tr>
</table>

   <p>Here's a trivial program that illustrates the use of <code>exit</code> and
<code>atexit</code>:

<pre class="smallexample">

     #include &lt;stdio.h&gt;
     #include &lt;stdlib.h&gt;
     
     void
     bye (void)
     {
       puts ("Goodbye, cruel world....");
     }
     
     int
     main (void)
     {
       atexit (bye);
       exit (EXIT_SUCCESS);
     }
     </pre>

<p>When this program is executed, it just prints the message and exits.

   </body></html>

