<html lang="en">
<head>
<title>The GNU C Library</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The GNU C Library">
<meta name="generator" content="makeinfo 4.6">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
--></style>
</head>
<body>
<div class="node">
<p>
Node:&nbsp;<a name="fstab">fstab</a>,
Next:&nbsp;<a rel="next" accesskey="n" href="mtab.html#mtab">mtab</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Mount-Information.html#Mount%20Information">Mount Information</a>
<hr><br>
</div>

<h3 class="subsubsection">The <code>fstab</code> file</h5>

<p>The internal representation for entries of the file is <code>struct&nbsp;fstab</code>, defined in <code>fstab.h</code>.

<p>
<table width="100%">
<tr>
<td align="left"><b>struct fstab</b><i>
     </i></td>
<td align="right">Data Type</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This structure is used with the <code>getfsent</code>, <code>getfsspec</code>, and
<code>getfsfile</code> functions.

          <dl>
<dt><code>char *fs_spec</code>
          <dd>This element describes the device from which the filesystem is mounted. 
Normally this is the name of a special device, such as a hard disk
partition, but it could also be a more or less generic string.  For
<dfn>NFS</dfn> it would be a hostname and directory name combination.

          <p>Even though the element is not declared <code>const</code> it shouldn't be
modified.  The missing <code>const</code> has historic reasons, since this
function predates ISO&nbsp;C.  The same is true for the other string
elements of this structure.

          <br><dt><code>char *fs_file</code>
          <dd>This describes the mount point on the local system.  I.e., accessing any
file in this filesystem has implicitly or explicitly this string as a
prefix.

          <br><dt><code>char *fs_vfstype</code>
          <dd>This is the type of the filesystem.  Depending on what the underlying
kernel understands it can be any string.

          <br><dt><code>char *fs_mntops</code>
          <dd>This is a string containing options passed to the kernel with the
<code>mount</code> call.  Again, this can be almost anything.  There can be
more than one option, separated from the others by a comma.  Each option
consists of a name and an optional value part, introduced by an <code>=</code>
character.

          <p>If the value of this element must be processed it should ideally be done
using the <code>getsubopt</code> function; see <a href="Suboptions.html#Suboptions">Suboptions</a>.

          <br><dt><code>const char *fs_type</code>
          <dd>This name is poorly chosen.  This element points to a string (possibly
in the <code>fs_mntops</code> string) which describes the modes with which the
filesystem is mounted.  <code>fstab</code> defines five macros to describe the
possible values:

               <dl>
<dt><code>FSTAB_RW</code>
               <dd>The filesystems gets mounted with read and write enabled. 
<br><dt><code>FSTAB_RQ</code>
               <dd>The filesystems gets mounted with read and write enabled.  Write access
is restricted by quotas. 
<br><dt><code>FSTAB_RO</code>
               <dd>The filesystem gets mounted read-only. 
<br><dt><code>FSTAB_SW</code>
               <dd>This is not a real filesystem, it is a swap device. 
<br><dt><code>FSTAB_XX</code>
               <dd>This entry from the <code>fstab</code> file is totally ignored. 
</dl>

          <p>Testing for equality with these value must happen using <code>strcmp</code>
since these are all strings.  Comparing the pointer will probably always
fail.

          <br><dt><code>int fs_freq</code>
          <dd>This element describes the dump frequency in days.

          <br><dt><code>int fs_passno</code>
          <dd>This element describes the pass number on parallel dumps.  It is closely
related to the <code>dump</code> utility used on Unix systems. 
</dl>
     </td></tr>
</table>

   <p>To read the entire content of the of the <code>fstab</code> file the GNU libc
contains a set of three functions which are designed in the usual way.

<p>
<table width="100%">
<tr>
<td align="left">int <b>setfsent</b><i> </i>(<i>void</i>)<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This function makes sure that the internal read pointer for the
<code>fstab</code> file is at the beginning of the file.  This is done by
either opening the file or resetting the read pointer.

     <p>Since the file handle is internal to the libc this function is not
thread-safe.

     <p>This function returns a non-zero value if the operation was successful
and the <code>getfs*</code> functions can be used to read the entries of the
file. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left">void <b>endfsent</b><i> </i>(<i>void</i>)<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This function makes sure that all resources acquired by a prior call to
<code>setfsent</code> (explicitly or implicitly by calling <code>getfsent</code>) are
freed. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left">struct fstab * <b>getfsent</b><i> </i>(<i>void</i>)<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This function returns the next entry of the <code>fstab</code> file.  If this
is the first call to any of the functions handling <code>fstab</code> since
program start or the last call of <code>endfsent</code>, the file will be
opened.

     <p>The function returns a pointer to a variable of type <code>struct
fstab</code>.  This variable is shared by all threads and therefore this
function is not thread-safe.  If an error occurred <code>getfsent</code>
returns a <code>NULL</code> pointer. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left">struct fstab * <b>getfsspec</b><i> </i>(<i>const char *</i><var>name</var><i></i>)<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This function returns the next entry of the <code>fstab</code> file which has
a string equal to <var>name</var> pointed to by the <code>fs_spec</code> element. 
Since there is normally exactly one entry for each special device it
makes no sense to call this function more than once for the same
argument.  If this is the first call to any of the functions handling
<code>fstab</code> since program start or the last call of <code>endfsent</code>,
the file will be opened.

     <p>The function returns a pointer to a variable of type <code>struct
fstab</code>.  This variable is shared by all threads and therefore this
function is not thread-safe.  If an error occurred <code>getfsent</code>
returns a <code>NULL</code> pointer. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left">struct fstab * <b>getfsfile</b><i> </i>(<i>const char *</i><var>name</var><i></i>)<i>
     </i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This function returns the next entry of the <code>fstab</code> file which has
a string equal to <var>name</var> pointed to by the <code>fs_file</code> element. 
Since there is normally exactly one entry for each mount point it
makes no sense to call this function more than once for the same
argument.  If this is the first call to any of the functions handling
<code>fstab</code> since program start or the last call of <code>endfsent</code>,
the file will be opened.

     <p>The function returns a pointer to a variable of type <code>struct
fstab</code>.  This variable is shared by all threads and therefore this
function is not thread-safe.  If an error occurred <code>getfsent</code>
returns a <code>NULL</code> pointer. 
</td></tr>
</table>

   </body></html>

