<html lang="en">
<head>
<title>The GNU C Library</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name=description content="The GNU C Library">
<meta name=generator content="makeinfo 4.2">
<link href="http://www.gnu.org/software/texinfo/" rel=generator-home>
</head>
<body>
<p>
Node:<a name="Working%20Directory">Working Directory</a>,
Next:<a rel=next accesskey=n href="Accessing-Directories.html#Accessing%20Directories">Accessing Directories</a>,
Up:<a rel=up accesskey=u href="File-System-Interface.html#File%20System%20Interface">File System Interface</a>
<hr><br>

<h3>Working Directory</h3>

<p>Each process has associated with it a directory, called its <dfn>current
working directory</dfn> or simply <dfn>working directory</dfn>, that is used in
the resolution of relative file names (see <a href="File-Name-Resolution.html#File%20Name%20Resolution">File Name Resolution</a>).

<p>When you log in and begin a new session, your working directory is
initially set to the home directory associated with your login account
in the system user database.  You can find any user's home directory
using the <code>getpwuid</code> or <code>getpwnam</code> functions; see <a href="User-Database.html#User%20Database">User Database</a>.

<p>Users can change the working directory using shell commands like
<code>cd</code>.  The functions described in this section are the primitives
used by those commands and by other programs for examining and changing
the working directory.

<p>Prototypes for these functions are declared in the header file
<code>unistd.h</code>.

<p>
<table width="100%">
<tr>
<td align="left">char * <b>getcwd</b><i> (char *<var>buffer</var>, size_t <var>size</var>)
</i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
The <code>getcwd</code> function returns an absolute file name representing
the current working directory, storing it in the character array
<var>buffer</var> that you provide.  The <var>size</var> argument is how you tell
the system the allocation size of <var>buffer</var>.

<p>The GNU library version of this function also permits you to specify a
null pointer for the <var>buffer</var> argument.  Then <code>getcwd</code>
allocates a buffer automatically, as with <code>malloc</code>
(see <a href="Unconstrained-Allocation.html#Unconstrained%20Allocation">Unconstrained Allocation</a>).  If the <var>size</var> is greater than
zero, then the buffer is that large; otherwise, the buffer is as large
as necessary to hold the result.

<p>The return value is <var>buffer</var> on success and a null pointer on failure. 
The following <code>errno</code> error conditions are defined for this function:

<dl>
<dt><code>EINVAL</code>
<dd>The <var>size</var> argument is zero and <var>buffer</var> is not a null pointer.

<br><dt><code>ERANGE</code>
<dd>The <var>size</var> argument is less than the length of the working directory
name.  You need to allocate a bigger array and try again.

<br><dt><code>EACCES</code>
<dd>Permission to read or search a component of the file name was denied. 
</dl>
</td></tr>
</table>

<p>You could implement the behavior of GNU's <code>getcwd&nbsp;(NULL,&nbsp;0)</code>
using only the standard behavior of <code>getcwd</code>:

<br><pre>char *
gnu_getcwd ()
{
  size_t size = 100;

  while (1)
    {
      char *buffer = (char *) xmalloc (size);
      if (getcwd (buffer, size) == buffer)
        return buffer;
      free (buffer);
      if (errno != ERANGE)
        return 0;
      size *= 2;
    }
}
</pre>

<p>See <a href="Malloc-Examples.html#Malloc%20Examples">Malloc Examples</a>, for information about <code>xmalloc</code>, which is
not a library function but is a customary name used in most GNU
software.

<p>
<table width="100%">
<tr>
<td align="left">char * <b>getwd</b><i> (char *<var>buffer</var>)
</i></td>
<td align="right">Deprecated Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This is similar to <code>getcwd</code>, but has no way to specify the size of
the buffer.  The GNU library provides <code>getwd</code> only
for backwards compatibility with BSD.

<p>The <var>buffer</var> argument should be a pointer to an array at least
<code>PATH_MAX</code> bytes long (see <a href="Limits-for-Files.html#Limits%20for%20Files">Limits for Files</a>).  In the GNU
system there is no limit to the size of a file name, so this is not
necessarily enough space to contain the directory name.  That is why
this function is deprecated. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left">char * <b>get_current_dir_name</b><i> (void)
</i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This <code>get_current_dir_name</code> function is bascially equivalent to
<code>getcwd&nbsp;(NULL,&nbsp;0)</code>.  The only difference is that the value of
the <code>PWD</code> variable is returned if this value is correct.  This is a
subtle difference which is visible if the path described by the
<code>PWD</code> value is using one or more symbol links in which case the
value returned by <code>getcwd</code> can resolve the symbol links and
therefore yield a different result.

<p>This function is a GNU extension. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left">int <b>chdir</b><i> (const char *<var>filename</var>)
</i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This function is used to set the process's working directory to
<var>filename</var>.

<p>The normal, successful return value from <code>chdir</code> is <code>0</code>.  A
value of <code>-1</code> is returned to indicate an error.  The <code>errno</code>
error conditions defined for this function are the usual file name
syntax errors (see <a href="File-Name-Errors.html#File%20Name%20Errors">File Name Errors</a>), plus <code>ENOTDIR</code> if the
file <var>filename</var> is not a directory. 
</td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left">int <b>fchdir</b><i> (int <var>filedes</var>)
</i></td>
<td align="right">Function</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This function is used to set the process's working directory to
directory associated with the file descriptor <var>filedes</var>.

<p>The normal, successful return value from <code>fchdir</code> is <code>0</code>.  A
value of <code>-1</code> is returned to indicate an error.  The following
<code>errno</code> error conditions are defined for this function:

<dl>
<dt><code>EACCES</code>
<dd>Read permission is denied for the directory named by <code>dirname</code>.

<br><dt><code>EBADF</code>
<dd>The <var>filedes</var> argument is not a valid file descriptor.

<br><dt><code>ENOTDIR</code>
<dd>The file descriptor <var>filedes</var> is not associated with a directory.

<br><dt><code>EINTR</code>
<dd>The function call was interrupt by a signal.

<br><dt><code>EIO</code>
<dd>An I/O error occurred. 
</dl>
</td></tr>
</table>

</body></html>

