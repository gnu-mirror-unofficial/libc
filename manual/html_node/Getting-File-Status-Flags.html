<html lang="en">
<head>
<title>The GNU C Library</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The GNU C Library">
<meta name="generator" content="makeinfo 4.6">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
--></style>
</head>
<body>
<div class="node">
<p>
Node:&nbsp;<a name="Getting%20File%20Status%20Flags">Getting File Status Flags</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Operating-Modes.html#Operating%20Modes">Operating Modes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="File-Status-Flags.html#File%20Status%20Flags">File Status Flags</a>
<hr><br>
</div>

<h3 class="subsection">Getting and Setting File Status Flags</h4>

<p>The <code>fcntl</code> function can fetch or change file status flags.

<p>
<table width="100%">
<tr>
<td align="left">int <b>F_GETFL</b><i>
     </i></td>
<td align="right">Macro</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This macro is used as the <var>command</var> argument to <code>fcntl</code>, to
read the file status flags for the open file with descriptor
<var>filedes</var>.

     <p>The normal return value from <code>fcntl</code> with this command is a
nonnegative number which can be interpreted as the bitwise OR of the
individual flags.  Since the file access modes are not single-bit values,
you can mask off other bits in the returned flags with <code>O_ACCMODE</code>
to compare them.

     <p>In case of an error, <code>fcntl</code> returns -1.  The following
<code>errno</code> error conditions are defined for this command:

          <dl>
<dt><code>EBADF</code>
          <dd>The <var>filedes</var> argument is invalid. 
</dl>
     </td></tr>
</table>

<p>
<table width="100%">
<tr>
<td align="left">int <b>F_SETFL</b><i>
     </i></td>
<td align="right">Macro</td>
</tr>
</table>
<table width="95%" align="center">
<tr><td>
This macro is used as the <var>command</var> argument to <code>fcntl</code>, to set
the file status flags for the open file corresponding to the
<var>filedes</var> argument.  This command requires a third <code>int</code>
argument to specify the new flags, so the call looks like this:

     <pre class="smallexample">          fcntl (<var>filedes</var>, F_SETFL, <var>new-flags</var>)
          </pre>

     <p>You can't change the access mode for the file in this way; that is,
whether the file descriptor was opened for reading or writing.

     <p>The normal return value from <code>fcntl</code> with this command is an
unspecified value other than -1, which indicates an error.  The
error conditions are the same as for the <code>F_GETFL</code> command. 
</td></tr>
</table>

   <p>If you want to modify the file status flags, you should get the current
flags with <code>F_GETFL</code> and modify the value.  Don't assume that the
flags listed here are the only ones that are implemented; your program
may be run years from now and more flags may exist then.  For example,
here is a function to set or clear the flag <code>O_NONBLOCK</code> without
altering any other flags:

<pre class="smallexample">     /* Set the <code>O_NONBLOCK</code> flag of <var>desc</var> if <var>value</var> is nonzero,
        or clear the flag if <var>value</var> is 0.
        Return 0 on success, or -1 on error with <code>errno</code> set. */
     
     int
     set_nonblock_flag (int desc, int value)
     {
       int oldflags = fcntl (desc, F_GETFL, 0);
       /* If reading the flags failed, return error indication now. */
       if (oldflags == -1)
         return -1;
       /* Set just the flag we want to set. */
       if (value != 0)
         oldflags |= O_NONBLOCK;
       else
         oldflags &amp;= ~O_NONBLOCK;
       /* Store modified flag word in the descriptor. */
       return fcntl (desc, F_SETFL, oldflags);
     }
     </pre>

   </body></html>

